---
title: "Funktionelle Genomanalysen 2023 (09-CRT-A006)"
subtitle: "Tutorial: Colokalisierung & Mendelische Randomisierung" 
author: "Dr. Janne Pott"
date: "09.-11. Juni 2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Allgemeine Informationen

**Ziel**: Das Ziel dieses Tutoriums ist es, fuer zwei Phaenotypen eine Colokalisationsanalyse und eine Mendelische Randomisierung durchzufuehren, um die praktische Anwendung und Interpretation der Ergebnisse aufzufuehren. 

**Daten**: Wir werden in diesem Beispiel Teilmengen von bereits publizierten GWAS verwenden

- LDLC Summary Statistics von [Surakka, I. et al. The impact of low-frequency and rare variants on lipid levels. Nat. Genet. 47, 589–597 (2015).](https://www.nature.com/articles/ng.3300), Link to data: http://diagram-consortium.org/2015_ENGAGE_1KG/
- CAD Summary Statistics von [Nikpay, M. et al. A comprehensive 1,000 Genomes-based genome-wide association meta-analysis of coronary artery disease. Nat. Genet. 47, 1121–1130 (2015).](https://www.nature.com/articles/ng.3396), Link to data: http://www.cardiogramplusc4d.org/data-downloads/
- Sitosterol Summary Statistics von [Scholz, M. et al. Genome-wide meta-analysis of phytosterols reveals five novel loci and a detrimental effect on coronary atherosclerosis. Nat Commun 13, 143 (2022).](https://www.nature.com/articles/s41467-021-27706-6), Link to data: https://zenodo.org/record/5607613

Diese Beispieldaten wurden gewaehlt, weil sie auch in der Vorlesung vorkommen. Allerdings wird hier nur ein Lokus betrachtet: 


## Coloc

In diesem Abschnitt werden wir drei Colocalisierungen in R durchfuehren

Weitere Inforamtionen zum *coloc* R-Paket finden Sie unter https://chr1swallace.github.io/coloc/.

### Initialisierung

Zuerst laden wir alle notwendigen Pakete und legen die Genregion fest.

```{r cars}
# load required packages
library(coloc)
library(data.table)
setDTthreads(1)
library(ggplot2)
library(ggpubr)
```

Zusaetzlich legen wir die Genregion fest, die wir analysieren wollen 

```{r generegion}
genechr = 1
genestart = 1
genestop = 1
genewindow = 200
  
```

### Daten einlesen
Im Moodle-Kurs finden Sie eine .RData Datei, die bereits alle notwendigen Tabellen enthaelt und einfach in R eingelesen werden kann. Sie enthaelt die folgenden *data.tables*:

- tab_ldl 
- tab_cad
- tab_sit

Das R-Paket *data.table* ist sehr performant fuer das handling von grossen Daten in R. Weitere Infos dazu finden Sie unter https://r-datatable.com.

```{r load, eval = FALSE}
load()
ls()

str(tab_ldl)
str(tab_cad)
str(tab_sit)


```

